<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ランキング受賞画像自動生成</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Noto Sans JP", sans-serif;
      }
      .setting-card {
        background-color: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 0.75rem;
        margin-bottom: 1.5rem;
        padding: 1.5rem;
      }
      label {
        display: block;
        font-weight: 500;
        color: #3f3a39;
        margin-bottom: 0.5rem;
        font-size: 0.875rem;
      }
      input[type="text"],
      input[type="number"],
      select {
        width: 100%;
        padding: 0.5rem 0.75rem;
        border-radius: 0.375rem;
        border: 1px solid #d1d5db;
        font-size: 0.875rem;
      }

      /* ================================================= */
      /* CÁC STYLE TÙY CHỈNH CHO PHẦN TEMPLATE ĐÃ CHỈNH SỬA */
      /* ================================================= */

      .template-image-container {
        width: 130px;
        height: 190px;
        border-radius: 0.5rem;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        transition: border 0.1s;
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
        border: 2px solid transparent;
        /* Mặc định cho Template 1 (Trắng) */
        background-color: #ffffff;
      }
      .template-image-container.light-green {
        /* Màu nền cho các template KHÔNG được chọn */
        background-color: #e8f5e9;
      }
      .template-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      
      /* Cấu trúc mới cho Label và Radio Button */
      .radio-container {
        display: flex; /* Bật flexbox cho radio button và tên template */
        flex-direction: column;
        align-items: center;
      }
      
      .template-selection-box {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        margin-bottom: 0.5rem; /* Khoảng cách giữa hộp template và phần radio/label */
      }
      
      .radio-input-group {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        padding: 0.5rem 0; /* Đệm xung quanh radio button */
      }

      .radio-container input[type="radio"] {
        position: absolute;
        opacity: 0;
        cursor: pointer;
      }

      /* Style khi radio được chọn */
      .radio-container input[type="radio"]:checked + .template-selection-box .template-image-container {
        border: 2px solid #3b82f6;
        box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.5),
          0 2px 4px -1px rgba(59, 130, 246, 0.06);
      }
      
      /* Cần điều chỉnh lại để target label bên ngoài selection-box */
      .radio-container input[type="radio"]:checked ~ .radio-input-group .custom-radio {
        background-color: #3b82f6;
        border-color: #3b82f6;
        box-shadow: 0 0 0 4px white inset;
      }

      .radio-label-name {
        margin-left: 0.5rem; /* Khoảng cách giữa radio và tên template */
        font-size: 0.875rem;
        color: #3f3a39;
        font-weight: 500;
        display: block;
      }
      
      .custom-radio {
        display: inline-block;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        border: 1px solid #9ca3af;
        margin-top: 0; /* Đặt lại margin */
        background-color: white;
        transition: all 0.1s;
        flex-shrink: 0; /* Không cho radio co lại */
      }

      /* Ẩn scrollbar */
      .template-scroll-container {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      .template-scroll-container::-webkit-scrollbar {
        display: none;
      }

      /* Giữ nguyên các style còn lại */
      .btn-header-primary {
        padding: 0.5rem 1.25rem;
        font-size: 0.875rem;
        font-weight: 500;
        border-radius: 0.5rem;
        background-color: #e6372e;
        color: white;
        transition: background-color 0.2s;
        border: none;
      }

      .btn-header-primary:hover {
        background-color: #cc2d25;
      }

      .btn-header-secondary {
        padding: 0.5rem 1.25rem;
        font-size: 0.875rem;
        font-weight: 500;
        border-radius: 0.5rem;
        background-color: white;
        border: 2px solid #e6372e;
        color: #e6372e;
        transition: background-color 0.2s, color 0.2s;
      }

      .btn-header-secondary:hover {
        background-color: #e6372e;
        color: white;
      }
    </style>
  </head>
  <body class="bg-gray-100 text-gray-800">
    <main class="p-4 sm:p-6 max-w-7xl mx-auto">
      <header
        class="bg-white shadow-md flex justify-between items-center px-4 sm:px-8 py-4 mb-6"
      >
        <h1 class="text-lg sm:text-xl font-bold text-[#3F3A39]">
          ランキング受賞画像自動生成
        </h1>

      </header>

  <div class="setting-card">
    <div
      class="flex justify-between items-center pb-4 border-b border-gray-200 mb-4"
    >
      <h2 class="text-xl font-bold text-[#3F3A39]">
        1. テンプレート選択
      </h2>
      <div class="flex items-center text-sm">
        <input
          type="checkbox"
          id="use-tool"
          class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
          checked
        />
        <label for="use-tool" class="ml-2 mb-0 text-gray-700 font-normal"
          >ランキング画像作成ツールを利用</label
        >
      </div>
    </div>
    <div class="relative py-4">
      <button
        id="scroll-left"
        class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-4 bg-white rounded-full p-1 shadow-md z-10 hover:bg-gray-100 border border-gray-300"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6 text-gray-600"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M15 19l-7-7 7-7"
          />
        </svg>
      </button>
      <div
        id="template-container"
        class="template-scroll-container flex items-end gap-4 overflow-x-auto scroll-smooth py-2 px-2"
      >
        <div 
          class="flex-shrink-0 text-center template-item-container"
          data-template-id="1"
        >
          <div 
            class="template-image-container cursor-pointer"
            onclick="selectTemplate(1, this)"
          >
            <span class="text-xl text-gray-700 font-medium">Template1</span>
          </div>
          <p class="text-sm font-medium text-gray-700 mt-2">テンプレート 1</p>
        </div>

        <div 
          class="flex-shrink-0 text-center template-item-container"
          data-template-id="2"
        >
          <div 
            class="template-image-container light-green cursor-pointer"
            onclick="selectTemplate(2, this)"
          >
            <span class="text-xl text-gray-700 font-medium">Template2</span>
          </div>
          <p class="text-sm font-medium text-gray-700 mt-2">テンプレート 2</p>
        </div>
        
        <div 
          class="flex-shrink-0 text-center template-item-container"
          data-template-id="3"
        >
          <div 
            class="template-image-container light-green cursor-pointer"
            onclick="selectTemplate(3, this)"
          >
            <span class="text-xl text-gray-700 font-medium">Template3</span>
          </div>
          <p class="text-sm font-medium text-gray-700 mt-2">テンプレート 3</p>
        </div>

        <div 
          class="flex-shrink-0 text-center template-item-container"
          data-template-id="4"
        >
          <div 
            class="template-image-container light-green cursor-pointer"
            onclick="selectTemplate(4, this)"
          >
            <span class="text-xl text-gray-700 font-medium">Template4</span>
          </div>
          <p class="text-sm font-medium text-gray-700 mt-2">テンプレート 4</p>
        </div>

        <div 
          class="flex-shrink-0 text-center template-item-container"
          data-template-id="5"
        >
          <div 
            class="template-image-container light-green cursor-pointer"
            onclick="selectTemplate(5, this)"
          >
            <span class="text-xl text-gray-700 font-medium">Template5</span>
          </div>
          <p class="text-sm font-medium text-gray-700 mt-2">テンプレート 5</p>
        </div>

        <div 
          class="flex-shrink-0 text-center template-item-container"
          data-template-id="6"
        >
          <div 
            class="template-image-container light-green cursor-pointer"
            onclick="selectTemplate(6, this)"
          >
            <span class="text-xl text-gray-700 font-medium">Template6</span>
          </div>
          <p class="text-sm font-medium text-gray-700 mt-2">テンプレート 6</p>
        </div>

        <div 
          class="flex-shrink-0 text-center template-item-container"
          data-template-id="7"
        >
          <div 
            class="template-image-container light-green cursor-pointer"
            onclick="selectTemplate(7, this)"
          >
            <span class="text-xl text-gray-700 font-medium">Template7</span>
          </div>
          <p class="text-sm font-medium text-gray-700 mt-2">テンプレート 7</p>
        </div>
      </div>
      <button
        id="scroll-right"
        class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-4 bg-white rounded-full p-1 shadow-md z-10 hover:bg-gray-100 border border-gray-300"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6 text-gray-600"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"
          />
        </svg>
      </button>
    </div>
</div>

     <hr class="border-gray-300 my-6" /> <div class="setting-card mt-6">
        <h2 class="text-xl font-bold text-[#3F3A39] mb-4">2. 詳細設定</h2>
        <p class="font-semibold text-gray-700 mb-4">
          ランキング画像のサイズ設定　　　　　　　　　　　　　　　　　　　　　　　　　画像挿入位置
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-4 rounded-md bg-gray-50 border">
          <div id="pc-setting-container" class="space-y-4">
            <div>
              <label for="pc-width-value">PC用 横幅の調整</label>
              <div class="flex items-center space-x-2">
                <input
                  type="number"
                  id="pc-width-value"
                  value="100"
                  min="1"
                  class="w-1/2 sm:w-2/5"
                />
                <select id="pc-width-unit" class="w-1/4 sm:w-1/5" data-device="pc">
                  <option value="%">%</option>
                  <option value="px">px</option>
                </select>
                <span id="pc-unit-label" class="text-gray-600"></span>
              </div>
              <p class="mt-2 text-xs text-gray-500">
                <span id="pc-min-max-info">Min: 1%, Max: 100%</span>
              </p>
            </div>
          </div>
          
          <div id="pc-position-container" class="space-y-4">
             <div>
               <label class="text-sm font-medium text-gray-700 mb-2">挿入位置を選択してください</label>
               <div class="space-y-2">
                 <div class="flex items-center">
                   <input
                     type="radio"
                     id="pc_pos_before"
                     name="pc-insertion-position"
                     value="before"
                     class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"
                     checked
                   />
                   <label
                     for="pc_pos_before"
                     class="ml-2 text-gray-700 font-normal mb-0 text-sm"
                     >説明文の前</label
                   >
                 </div>
 
                 <div class="flex items-center">
                   <input
                     type="radio"
                     id="pc_pos_after"
                     name="pc-insertion-position"
                     value="after"
                     class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"
                   />
                   <label
                     for="pc_pos_after"
                     class="ml-2 text-gray-700 font-normal mb-0 text-sm"
                     >説明文の後</label
                   >
                 </div>
               </div>
             </div>
          </div>

          <div class="md:col-span-2 border-t border-gray-200 pt-4"></div>
          
          <div id="sp-setting-container" class="space-y-4">
            <div>
              <label for="sp-width-value">スマホ用 横幅の調整</label>
              <div class="flex items-center space-x-2">
                <input
                  type="number"
                  id="sp-width-value"
                  value="100"
                  min="1"
                  class="w-1/2 sm:w-2/5"
                />
                <select id="sp-width-unit" class="w-1/4 sm:w-1/5" data-device="sp">
                  <option value="%">%</option>
                  <option value="px">px</option>
                </select>
                <span id="sp-unit-label" class="text-gray-600"></span>
              </div>
              <p class="mt-2 text-xs text-gray-500">
                <span id="sp-min-max-info">Min: 1%, Max: 100%</span>
              </p>
            </div>
          </div>
          
          <div id="sp-position-container" class="space-y-4">
             <div>
               <label class="text-sm font-medium text-gray-700 mb-2">挿入位置を選択してください</label>
               <div class="space-y-2">
                 <div class="flex items-center">
                   <input
                     type="radio"
                     id="sp_pos_before"
                     name="sp-insertion-position"
                     value="before"
                     class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"
                     checked
                   />
                   <label
                     for="sp_pos_before"
                     class="ml-2 text-gray-700 font-normal mb-0 text-sm"
                     >説明文の前</label
                   >
                 </div>
 
                 <div class="flex items-center">
                   <input
                     type="radio"
                     id="sp_pos_after"
                     name="sp-insertion-position"
                     value="after"
                     class="h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"
                   />
                   <label
                     for="sp_pos_after"
                     class="ml-2 text-gray-700 font-normal mb-0 text-sm"
                     >説明文の後</label
                   >
                 </div>
               </div>
             </div>
          </div>

        </div>
      </div>
      
<div class="flex justify-end pl-4 sm:pl-0 mt-8 mb-8"> 
    <button id="preview-btn" class="btn-header-secondary">
        設定を保存
    </button>
</div>
      </main>

    <script>
      // --- Preview Button Logic ---
      const previewBtn = document.getElementById("preview-btn");
      previewBtn.addEventListener("click", () => {
        window.location.href = "settingok.html";
      });

      // --- Width Setting Logic (Cài đặt kích thước ảnh cho PC và SP) ---
      document.addEventListener("DOMContentLoaded", () => {
        // Hàm chung để cập nhật trường nhập liệu dựa trên đơn vị
        function updateWidthInput(device) {
          const unitSelect = document.getElementById(`${device}-width-unit`);
          const valueInput = document.getElementById(`${device}-width-value`);
          const unitLabel = document.getElementById(`${device}-unit-label`);
          const minMaxInfo = document.getElementById(`${device}-min-max-info`);

          const selectedUnit = unitSelect.value;
          unitLabel.textContent = selectedUnit;

          if (selectedUnit === "%") {
            // Cài đặt cho %
            valueInput.value = 100;
            valueInput.setAttribute("min", "1");
            valueInput.setAttribute("max", "100");
            minMaxInfo.textContent = "Min: 1%, Max: 100%";
          } else if (selectedUnit === "px") {
            // Cài đặt cho px
            valueInput.value = device === "pc" ? 900 : 320;
            valueInput.setAttribute("min", "1");
            valueInput.removeAttribute("max");
            minMaxInfo.textContent = "Min: 1px (Không có giới hạn Max cố định)";
          }
        }

        // Khởi tạo và lắng nghe sự kiện cho PC
        const pcUnitSelect = document.getElementById("pc-width-unit");
        pcUnitSelect.addEventListener("change", () => updateWidthInput("pc"));
        updateWidthInput("pc");

        // Khởi tạo và lắng nghe sự kiện cho Smartphone
        const spUnitSelect = document.getElementById("sp-width-unit");
        spUnitSelect.addEventListener("change", () => updateWidthInput("sp"));
        updateWidthInput("sp");

        // --- Template Selector Logic (Scrolling and Selection) ---
        const scrollContainer = document.getElementById("template-container");
        const scrollLeftBtn = document.getElementById("scroll-left");
        const scrollRightBtn = document.getElementById("scroll-right");
        const scrollAmount = 150;

        scrollLeftBtn.addEventListener("click", () => {
          scrollContainer.scrollBy({ left: -scrollAmount, behavior: "smooth" });
        });
        scrollRightBtn.addEventListener("click", () => {
          scrollContainer.scrollBy({ left: scrollAmount, behavior: "smooth" });
        });

        // Xử lý sự kiện click trên label để chọn radio và cập nhật style
        document.querySelectorAll(".radio-container").forEach((container) => {
          const radioInput = container.querySelector('input[type="radio"]');
          const selectionBox = container.querySelector(
            ".template-selection-box"
          );
          const radioInputGroup = container.querySelector(".radio-input-group");

          // Lắng nghe click trên cả hộp template và radio group để chọn radio button
          selectionBox.addEventListener("click", (e) => {
            // Đảm bảo không xử lý double-click nếu click vào radio-input-group
            if (e.target.closest('.radio-input-group')) return;
            
            e.preventDefault();
            if (!radioInput.checked) {
              radioInput.checked = true;
              updateRadioStyles();
            }
          });
          
          radioInputGroup.addEventListener("click", (e) => {
            e.preventDefault();
            if (!radioInput.checked) {
              radioInput.checked = true;
              updateRadioStyles();
            }
          });


          // Cập nhật style khi trạng thái radio thay đổi
          radioInput.addEventListener("change", updateRadioStyles);
        });

        function updateRadioStyles() {
          document.querySelectorAll(".radio-container").forEach((container) => {
            const radioInput = container.querySelector('input[type="radio"]');
            const templateImageContainer = container.querySelector(
              ".template-image-container"
            );
            
            // Xóa border/shadow/background mặc định
            templateImageContainer.style.borderColor = 'transparent';
            templateImageContainer.style.boxShadow = '0 1px 3px 0 rgba(0, 0, 0, 0.1)';
            
            // Cập nhật custom radio style
            const customRadio = container.querySelector(".custom-radio");

            if (radioInput.checked) {
              // Template Box Style for SELECTED
              templateImageContainer.style.borderColor = '#3b82f6';
              templateImageContainer.style.boxShadow = '0 4px 6px -1px rgba(59, 130, 246, 0.5), 0 2px 4px -1px rgba(59, 130, 246, 0.06)';
              templateImageContainer.style.backgroundColor = '#ffffff';

              // Custom Radio Style for SELECTED
              customRadio.style.backgroundColor = '#3b82f6';
              customRadio.style.borderColor = '#3b82f6';
              customRadio.style.boxShadow = '0 0 0 4px white inset';
            } else {
              // Template Box Style for NOT SELECTED
              if (templateImageContainer.classList.contains('light-green')) {
                templateImageContainer.style.backgroundColor = '#e8f5e9'; 
              } else {
                templateImageContainer.style.backgroundColor = '#ffffff'; // Mặc định cho Template 1 (nếu có)
              }
              
              // Custom Radio Style for NOT SELECTED
              customRadio.style.backgroundColor = 'white';
              customRadio.style.borderColor = '#9ca3af';
              customRadio.style.boxShadow = 'none';
            }
          });
        }

        updateRadioStyles();
      });
    </script>
  </body>
</html>